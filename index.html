<!DOCTYPE html>
<html lang="de" class="h-full">

<head>
    <meta charset="UTF-8">
    <title>Sitzplangenerator</title>
    <link rel="stylesheet" href="libs/fontawesome/css/all.min.css?v=7.1.0">
    <!-- <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script> <!-- DEV -->
    <link rel="stylesheet" href="css/styles.css">
</head>

<body class="text-slate-900 h-full flex flex-col">
    <header class="border-b border-slate-400 px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <h1>Sitzplangenerator</h1>
        </div>
        
        <div class="flex items-center gap-3">
            <a href="help.html" class="cursor-pointer text-slate-500 hover:text-slate-800" title="Benutzungsanleitung">
                <i class="fa-solid fa-lightbulb text-xl"></i>
            </a>
        </div>
    </header>
    <div class="flex flex-1 overflow-hidden">
        <aside id="sidebar" class="relative w-80 border-r border-slate-400 flex flex-col transition-all duration-300 overflow-hidden">
            <i id="sidebar-toggle" class="absolute top-1 right-1 fa-solid fa-chevron-left cursor-pointer"></i>
            <div id="sidebar-controls" class="flex-1 overflow-y-auto space-y-8 p-6">
                <section class="space-y-4">
                    <h2>Konfiguration</h2>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-slate-700">Anzahl Sitzplätze</label>
                        <div class="flex gap-2">
                            <input id="seatCount" class="w-16" type="number" value="0" min="1">
                            <button id="draw-seats" onclick="createSeats()" class="btn-primary flex-1">
                                <i class="fa-solid fa-object-ungroup"></i> Sitzplätze neu zeichnen
                            </button>
                            <button id="clear-seats" onclick="clearSeats()" class="btn-primary flex-1 hidden">
                                <i class="fa-solid fa-eraser"></i> Sitzplätze leeren
                            </button>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-slate-700 flex items-center gap-1">
                            Namen <span class="text-slate-400 text-xs font-normal">(semikolon&#8209;getrennt)</span>
                        </label>
                        <div class="relative">
                            <textarea id="namesInput" class="flex w-full min-h-8 h-8 justify-center px-2 pr-7" placeholder="Antonia; Bernd; Caspar ..." rows="4"></textarea>
                            <span id="edit-icon" class="absolute bottom-1.5 right-1.5 pl-2 cursor-pointer">
                                <i class="fa-solid fa-pen-to-square"></i>
                            </span>
                        </div>

                    </div>
                </section>
                <section class="space-y-2">
                    <h2>Aktionen</h2>
                    <button onclick="assignNames(false)" class="btn-important w-full">
                        <i class="fa-solid fa-arrows-down-to-people"></i>
                            Namen übertragen
                    </button>
                    <button onclick="assignNames()" class="btn-important w-full">
                        <i class="fa-solid fa-shuffle"></i>
                            Sitzplätze auslosen
                    </button>
                    <button onclick="saveSeats()" class="btn-secondary w-full">
                        <i class="fa-solid fa-floppy-disk"></i> Sitzplätze in Browser speichern
                    </button>
                    <button onclick="saveNames()" class="btn-secondary w-full">
                        <i class="fa-solid fa-floppy-disk"></i> Namen in Browser speichern
                    </button>
                    <button onclick="deleteLocalStorage()" class="btn-secondary w-full">
                        <i class="fa-solid fa-trash"></i> Browser-Speicher löschen
                    </button>
                </section>
                <div class="space-y-2">
                    <section class="flex justify-between items-center">
                        <h2 class="h2-bold m-0">Erweiterte Funktionen</h2>
                        <label class="cursor-pointer">
                            <input type="checkbox" id="advanced-toggle" class="hidden">
                            <span id="advanced-toggle-label"></span>
                        </label>
                    </section>
                    <div id="advanced-controls" class="space-y-8 hidden">
                        <section class="space-y-4">
                            <h2>Import/Export</h2>
                            <input id="importFile" type="file" accept=".json" class="hidden">
                            <div class="flex gap-2">
                                <button onclick="importSeats()" class="btn-secondary wrap w-full">
                                    <i class="fa-solid fa-file-import"></i> Sitzplätze importieren
                                </button>
                                <button onclick="exportSeats()" class="btn-primary wrap w-full">
                                    <i class="fa-solid fa-download"></i> Sitzplätze exportieren</button>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="importNames()" class="btn-secondary wrap w-full">
                                    <i class="fa-solid fa-file-import"></i> Namen importieren</button>
                                <button onclick="exportNames()" class="btn-primary wrap w-full">
                                    <i class="fa-solid fa-download"></i> Namen exportieren</button>
                            </div>
                        </section>
                        <section class="space-y-4">
                            <h2>Feste Elemente</h2>
                            <div class="flex gap-2">
                                <button onclick="addFixedElement('desk')" class="btn-primary w-full">
                                    <i class="fa-solid fa-briefcase"></i><br/>Pult
                                </button>
                                <button onclick="addFixedElement('board')" class="btn-primary w-full">
                                    <i class="fa-solid fa-chalkboard"></i><br/>Tafel
                                </button>
                                <button onclick="addFixedElement('door')" class="btn-primary w-full">
                                    <i class="fa-solid fa-door-open"></i><br/>Tür
                                </button>
                                <button onclick="addFixedElement('window')" class="btn-primary w-full">
                                    <i class="fa-solid fa-table"></i><br/>Fenster
                                </button>
                            </div>
                        </section>
                        <section class="space-y-4">
                            <h2>Anzeigeoptionen</h2>
                            <label class="flex w-fit items-center gap-3 text-sm text-slate-700 cursor-pointer">
                                <input id="seatNumber-checkbox" type="checkbox">
                                Sitzplatznummern anzeigen
                            </label>
                            <label class="flex w-fit items-center gap-3 text-sm text-slate-700 cursor-pointer">
                                <input id="seatConnector-checkbox" type="checkbox">
                                Sitzplatzverbindungen anzeigen
                            </label>
                            <label class="flex w-fit items-center gap-3 text-sm text-slate-700 cursor-pointer">
                                <input id="countdown-checkbox" type="checkbox">
                                Countdown bei Auslosung anzeigen
                            </label>
                        </section>
                    </div>
                </div>
            </div>
            <div id="sidebar-footer" class="border-t border-slate-300 px-6 py-4 flex justify-between text-xs">
                <a href="impressum.html" class="sidebar-footer-link">
                    Impressum
                </a>
                <a href="datenschutz.html" class="sidebar-footer-link">
                    Datenschutzerklärung
                </a>
                <a href="https://github.com/mexterng/SeatplanGenerator" class="sidebar-footer-link">
                    Quellcode
                </a>
            </div>
        </aside>
        <main id="workspace" class="relative flex-1 min-w-0 max-w-full p-6 h-full">
            <div id="viewport" class="relative w-full h-full overflow-hidden border-2 border-dashed border-slate-300 rounded-2xl canvas-dot-grid flex items-center justify-center overflow-hidden cursor-grab">
                <div id="transform-container" class="absolute top-0 left-0 w-full h-full" style="transform-origin: 0 0;">         
                    <div id="canvas" 
                        class="absolute top-0 left-0 w-full h-full">
                    </div>
                    <svg id="connection-layer" 
                        class="absolute top-0 left-0 w-full h-full pointer-events-none invisible">
                    </svg>
                </div>
            </div>

            <div class="absolute top-0 right-0 mt-10 mr-10 z-20">
                <button id="exportBtn" class="btn-primary"><i class="fa-solid fa-download"></i> PDF Export</button>
            </div>

            <div class="absolute bottom-0 left-0 mb-10 ml-10 z-20 flex gap-2">
                <i id="clearCanvasBtn" class="fa-solid fa-trash cursor-pointer text-[var(--color-important)] hover:text-[var(--color-important-hover)]"></i>
            </div>

            <div class="absolute bottom-0 right-0 mb-10 mr-10 z-20 flex gap-2">
                <button id="zoomOutBtn" class="btn-secondary"><i class="fa-solid fa-minus"></i></button>
                <button id="zoomInBtn" class="btn-secondary"><i class="fa-solid fa-plus"></i></button>
                <button id="fitViewBtn" class="btn-secondary"><i class="fa-solid fa-expand"></i> Ausrichten</button>
            </div>
        </main>

        <div id="exportOverlay" class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 hidden">
            <div class="bg-white p-5 rounded-lg w-[350px] shadow-lg">
                <h3 class="mt-0 mb-3 text-lg font-semibold">PDF Export</h3>
                <div class="flex flex-col gap-4">
                    <label>
                        Name der Klasse:<br>
                        <input type="text" id="className" class="w-full">
                    </label>

                    <label>
                        Stand:<br>
                        <input type="date" id="dateFrom" class="w-full">
                    </label>

                    <label>
                        Gültig bis:<br>
                        <input type="date" id="dateTo" class="w-full">
                    </label>

                    <label>
                        Name der Lehrkraft:<br>
                        <input type="text" id="teacherName" class="w-full">
                    </label>
                    
                    <div class="flex justify-between">
                        <button id="exportPdfBtn" class="btn-primary">Exportieren</button>
                        <button id="cancelExportBtn" class="btn-secondary">Abbrechen</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="libs/html2canvas.min.js?v=1.4.1"></script>
    <script src="libs/jspdf.umd.min.js?v=2.5.1"></script>
    <script src="js/general.js"></script>
    <script src="js/script.js"></script>
    <script src="js/advanced-tools.js"></script>
    <script src="js/pdf-export.js"></script>
</body>

</html>